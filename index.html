<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Princess & The Smaumb</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&family=Great+Vibes&family=Indie+Flower&display=swap" rel="stylesheet">
    <style>
        body, html { margin: 0; padding: 0; background-color: #000; font-family: 'Poppins', sans-serif; height: 100vh; width: 100vw; overflow: hidden; color: white; -webkit-font-smoothing: antialiased; }
        .story-container { position: relative; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        
        /* IPAD FIX: Forces video and images to cover the screen */
        .media-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1; }
        .media-layer.contain { object-fit: contain; background: #000; } /* For GIFs */

        .text-overlay { position: absolute; bottom: 0; left: 0; width: 100%; padding: 40px 20px 80px 20px; background: linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.6) 50%, transparent 100%); z-index: 10; text-align: center; box-sizing: border-box; }
        
        h1 { font-family: 'Great Vibes', cursive; color: #ff4d6d; font-size: 3rem; margin: 0; text-shadow: 2px 2px 8px rgba(0,0,0,1); line-height: 1.2; }
        p { font-size: 1.2rem; line-height: 1.5; color: #f1f1f1; margin-top: 10px; text-shadow: 1px 1px 4px rgba(0,0,0,1); }

        /* BUTTONS */
        .btn-group { display: none; position: absolute; bottom: 180px; left: 0; width: 100%; justify-content: center; gap: 20px; z-index: 100; }
        button { padding: 18px 45px; border-radius: 50px; border: none; font-size: 1.4rem; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        .yes-btn { background: #ff4d6d; color: white; }
        .no-btn { background: white; color: black; transition: all 0.2s; }

        /* ENVELOPE & LETTER - Updated for Long Text */
        #envelope-stage { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffc2d1; z-index: 200; justify-content: center; align-items: center; flex-direction: column; }
        .envelope { width: 300px; height: 200px; background: #d90429; position: relative; cursor: pointer; box-shadow: 0 10px 30px rgba(0,0,0,0.3); transition: transform 0.3s; }
        .envelope:hover { transform: scale(1.05); }
        .flap { position: absolute; top: 0; border-left: 150px solid transparent; border-right: 150px solid transparent; border-top: 100px solid #ef233c; transform-origin: top; transition: transform 0.6s; z-index: 5; }
        .flap.open { transform: rotateX(180deg); }
        .pocket { position: absolute; bottom: 0; border-left: 150px solid transparent; border-right: 150px solid transparent; border-bottom: 200px solid #d90429; z-index: 4; }
        
        .letter { position: absolute; top: 10px; left: 10px; width: 280px; height: 180px; background: #fffdf5; padding: 20px; box-sizing: border-box; z-index: 2; transition: all 1s ease-in-out; border-radius: 5px; box-shadow: 0 0 15px rgba(0,0,0,0.1); }
        
        /* EXPANDED LETTER STYLE */
        .letter.full-screen { position: fixed; top: 20px !important; left: 50% !important; transform: translateX(-50%) !important; width: 90% !important; max-width: 600px; height: 90vh !important; z-index: 300 !important; overflow-y: auto; padding: 40px 30px; border-radius: 10px; }
        
        .letter-content { opacity: 0; font-family: 'Indie Flower', cursive; color: #1a1a1a; font-size: 1.2rem; line-height: 1.6; visibility: hidden; text-align: left; }
        .letter-content.visible { opacity: 1; visibility: visible; }
        .letter-content h2 { color: #d90429; font-size: 2rem; margin-top: 0; font-family: 'Great Vibes', cursive; text-align: center; margin-bottom: 20px; }
        .letter-content b { color: #d90429; }

        .progress-container { position: absolute; top: 15px; left: 10px; right: 10px; display: flex; gap: 4px; z-index: 50; }
        .bar { flex: 1; height: 4px; background: rgba(255,255,255,0.2); border-radius: 2px; overflow: hidden; }
        .bar-fill { height: 100%; width: 0%; background: #ff4d6d; transition: width 0.3s; }
        
        .tap-zone { position: absolute; top: 0; height: 100%; width: 50%; z-index: 20; }
        .tap-left { left: 0; } .tap-right { right: 0; }
    </style>
</head>
<body>
    <div class="story-container" id="story-container">
        <div class="progress-container" id="bars"></div>
        <div id="media-area"></div>
        <div class="text-overlay"><h1 id="title"></h1><p id="desc"></p></div>
        <div class="btn-group" id="btns">
            <button class="yes-btn" onclick="goNext()">YES ‚ù§Ô∏è</button>
            <button class="no-btn" id="noBtn" ontouchstart="handleNo()" onmouseover="handleNo()" onclick="handleNo()">No</button>
        </div>
        <div class="tap-zone tap-left" onclick="goPrev()"></div>
        <div class="tap-zone tap-right" onclick="goNext()"></div>
    </div>

    <div id="envelope-stage">
        <h2 style="color: #d90429; font-family: 'Great Vibes', cursive; font-size: 2.2rem; margin-bottom: 20px;">For My Real-Life Princess</h2>
        <div class="envelope" onclick="openEnvelope()">
            <div class="flap"></div><div class="pocket"></div>
            <div class="letter" id="letter">
                <div class="letter-content" id="letter-text">
                    <h2>To My Real-Life Disney Princess,</h2>
                    <p>
                        They say you have to kiss a lot of frogs to find your prince. In your case, you found a Bear‚Äîa <b>"Smaumb" Bear</b> who is smart enough to choose you, but dumb enough to wait until the very last second to tell you how much.<br><br>
                        Akhila, growing up you watched all those movies about magic and glass slippers. But watching you... that‚Äôs the real magic.<br><br>
                        You have <b>Moana's bravery</b> when life gets tough. You have <b>Belle's intelligence</b> when you handle the world (and me). You have <b>Rapunzel's light</b> that glows even on my darkest days. And when you wore that white saree? Yeah, Cinderella has nothing on you. You just woke up and chose violence.<br><br>
                        It‚Äôs crazy to think about "all these years" leading up to this moment. We‚Äôve waited so long for this‚Äîour First Valentine‚Äôs Day where I can actually look into your big, beautiful eyes instead of a screen. Where I can be with you.<br><br>
                        I want to tell you something I don't say enough: <b>You changed me.</b><br><br>
                        Before you, I was just... me. But loving you made me want to be better. You‚Äôve taught me patience (mostly by making me wait!), kindness, and what it truly means to value the "tiniest things"‚Äîlike a rose in your hair or a smile on your face. You turned me into the man I am today, just by being who you are.<br><br>
                        I know I‚Äôm not Prince Charming. I‚Äôm the guy who trips, forgets things, and panics. But I am also the guy who will always, always hold your hand when the clock strikes twelve.<br><br>
                        Thank you for accepting me (even when I'm an idiot).<br><br>
                        I love you, Akhila. Happy Valentine's Day. ‚ù§Ô∏è<br><br>
                        <i>Forever Yours,<br>Your Smaumb</i>
                    </p>
                    <img src="15_kiss.gif" style="width: 100%; border-radius: 10px; margin-top: 20px;">
                </div>
            </div>
        </div>
    </div>

    <script>
        // FULL STORY CONFIGURATION
        const story = [
            { src: '01_book.png', title: "The Smaumb Story", text: "I thought fairytales were just movies... until I met you." },
            { src: '02_akhila.png', title: "Her Highness", text: "Meet Akhila. Not just a girl, but a Queen. Wearing a Maroon Ballgown like royalty, but with an Apple Watch because she's a Boss Lady." },
            { src: '03_eyes.png', title: "Those Eyes...", text: "The Kajal. The Bindi. The Shape. I could get lost in them forever. (And trust me, I have.)" },
            { src: '04_hair.png', title: "Rapunzel Vibes", text: "Long, thick, and absolutely stunning. You don't need magic hair to enchant me, you already have it." },
            { src: '05_moana.png', title: "The Spirit", text: "You have the bravery of Moana. You face every wave in life with a fire that inspires me every day." },
            { src: '06_belle.png', title: "The Brains", text: "You are the 'Smart' in our 'Smaumb' duo. Witty, intelligent, and always keeping me on my toes." },
            { src: '07_tangled.png', title: "The 'Thingari Pilla'", text: "But you're also my clumsy Tangled princess. Tripping over things but looking cute doing it." },
            { src: '08_saree.mp4', title: "Real Life Magic", text: "And then... you wear a white saree and realize Cinderella has NOTHING on you. You just woke up and chose violence.", type: 'vid' },
            { src: '09_bear.png', title: "And Then Me...", text: "The Chubby Bear. (Note: The six-pack is there, it's just shy and hiding under the fur. Trust me.)" },
            { src: '10_smaumb.png', title: "The Duo", text: "Smart + Dumb = Smaumb. The Perfect Princess and the Goofy Bear. It makes no sense, but it's perfect." },
            // THE BIG QUESTION IS NOW THE TITLE
            { src: '11_ask.png', title: "Will You Be My Valentine?", text: "So... Since I waited till the last minute (dumb) to ask the girl of my dreams (smart)...", ask: true },
            { src: '14_happy.gif', title: "SHE SAID YES! üéâ", text: "Best. Valentine. Ever.", type: 'gif' },
            { end: true }
        ];

        let index = 0;
        let rejectCount = 0;
        const mediaArea = document.getElementById('media-area');
        const title = document.getElementById('title');
        const desc = document.getElementById('desc');
        const bars = document.getElementById('bars');
        const btns = document.getElementById('btns');

        // Create Progress Bars
        story.forEach((_, i) => { if(!story[i].end) bars.innerHTML += `<div class="bar"><div class="bar-fill" id="fill-${i}"></div></div>`; });

        function loadSlide(i) {
            // Check if we reached the end
            if (story[i].end) {
                document.getElementById('story-container').style.display = 'none';
                document.getElementById('envelope-stage').style.display = 'flex';
                return;
            }
            
            // Handle Video vs Image vs GIF
            let content = '';
            if (story[i].type === 'vid') {
                content = `<video class="media-layer" src="${story[i].src}" autoplay loop muted playsinline></video>`;
            } else if (story[i].type === 'gif') {
                content = `<img class="media-layer contain" src="${story[i].src}">`;
            } else {
                content = `<img class="media-layer" src="${story[i].src}">`;
            }
            
            mediaArea.innerHTML = content;
            title.innerText = story[i].title;
            desc.innerText = story[i].text;
            
            // Show Buttons ONLY on Slide 11 (The Ask)
            if (story[i].ask) {
                btns.style.display = 'flex';
                document.querySelector('.tap-right').style.pointerEvents = 'none'; // Stop user from skipping without answering
            } else {
                btns.style.display = 'none';
                document.querySelector('.tap-right').style.pointerEvents = 'auto';
            }
            
            // Update Bars
            for (let j = 0; j < story.length - 1; j++) {
                document.getElementById(`fill-${j}`).style.width = (j <= i) ? '100%' : '0%';
            }
        }

        function goNext() { if (index < story.length - 1) { index++; loadSlide(index); } }
        function goPrev() { if (index > 0) { index--; loadSlide(index); } }

        // The "Funny Rejection" Logic
        function handleNo() {
            rejectCount++;
            const noBtn = document.getElementById('noBtn');
            
            if (rejectCount === 1) {
                // Show Shocked Bear
                mediaArea.innerHTML = `<img class="media-layer" src="12_shock.png">`;
                title.innerText = "Wait... What?!";
                desc.innerText = "Is it the chubby cheeks? I'm working on them!";
                noBtn.innerText = "Still No";
            } else if (rejectCount === 2) {
                // Show Crying Bear
                mediaArea.innerHTML = `<img class="media-layer" src="13_cry.png">`;
                title.innerText = "Don't Break My Heart! üíî";
                desc.innerText = "I promise to be less dumb! Please!";
                noBtn.innerText = "Don't Care";
            } else {
                // Run Away Mode
                noBtn.style.position = 'fixed';
                noBtn.style.left = Math.random() * 60 + 20 + '%'; // Keep it somewhat on screen
                noBtn.style.top = Math.random() * 60 + 20 + '%';
            }
        }

        function openEnvelope() {
            document.querySelector('.flap').classList.add('open');
            setTimeout(() => {
                const letter = document.getElementById('letter');
                letter.classList.add('full-screen');
                setTimeout(() => { document.getElementById('letter-text').classList.add('visible'); }, 800);
            }, 600);
        }

        // Start Story
        loadSlide(0);
    </script>
</body>
</html>